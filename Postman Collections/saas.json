{
	"info": {
		"_postman_id": "bc3a2bb5-5282-490a-9031-4317e34e53bf",
		"name": "SaaS",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
	},
	"item": [
		{
			"name": "auth",
			"item": [
				{
					"name": "get_token_old",
					"id": "b5cc2e0e-0b20-4bf6-a63b-1b4ed71d2122",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\":\"{{USER_EMAIL}}\",\n    \"password\":\"{{USER_PASSWORD}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "{{CSPM_BASE_URL}}/v2/signin"
					},
					"response": []
				}
			],
			"id": "c07fd78e-7fe4-4cd7-9ec9-dbf2e5c85d6e",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "ec13d0bc-47e3-4d35-b913-a0dacd93ea40",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "2a5617be-c2c7-46e1-a687-7d722763f050",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "cwpp",
			"item": [
				{
					"name": "get_registries",
					"id": "e0a0dcb4-620e-45c3-b2c7-58e94877f278",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{CWPP_BASE_URL}}/api/v1/registries"
					},
					"response": []
				},
				{
					"name": "get_repositories",
					"id": "a7a0e583-e19e-416d-8811-55ee0ff3b2ce",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{CWPP_BASE_URL}}/api/v2/repositories"
					},
					"response": []
				},
				{
					"name": "get_repositories_filtered",
					"id": "0f4978ea-49a3-497e-b3f1-0e8b6985977f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/repositories?filter=alpine",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"repositories"
							],
							"query": [
								{
									"key": "filter",
									"value": "alpine"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "get_repositories_reg_filter",
					"id": "3d94f108-3f00-4043-a720-35d7a394679f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/repositories?registry=naunton",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"repositories"
							],
							"query": [
								{
									"key": "registry",
									"value": "naunton"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "get_image_reg_filter",
					"id": "e8906a9a-ae89-4495-a3ff-16fd4b057db9",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/images?registry=naunton",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"images"
							],
							"query": [
								{
									"key": "registry",
									"value": "naunton"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "get_images",
					"id": "4af407b6-b645-47f6-9952-990134820f03",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{CWPP_BASE_URL}}/api/v2/images"
					},
					"response": []
				},
				{
					"name": "get_images_filtered_raw",
					"id": "0070c16e-3d99-4d9c-bf72-b32428812003",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/images?registry=Docker Hub&filter=alpine&page=1&include_totals=true&order_by=name&image_name=alpine&name=alpine&page_size=10&repository=mcr.microsoft.com/dotnet/aspnet",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"images"
							],
							"query": [
								{
									"key": "registry",
									"value": "Docker Hub"
								},
								{
									"key": "filter",
									"value": "alpine"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "include_totals",
									"value": "true"
								},
								{
									"key": "order_by",
									"value": "name"
								},
								{
									"key": "image_name",
									"value": "alpine"
								},
								{
									"key": "name",
									"value": "alpine"
								},
								{
									"key": "page_size",
									"value": "10"
								},
								{
									"key": "repository",
									"value": "mcr.microsoft.com/dotnet/aspnet"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "get_images_filtered_raw_edit",
					"id": "045d8757-a77e-4be6-a622-5fc0c181b176",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/images?filter=alpine&image_name=alpine&name=alpine&repository=azuretestrepo",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"images"
							],
							"query": [
								{
									"key": "registry",
									"value": "Docker Hub",
									"disabled": true
								},
								{
									"key": "filter",
									"value": "alpine"
								},
								{
									"key": "page",
									"value": "1",
									"disabled": true
								},
								{
									"key": "include_totals",
									"value": "true",
									"disabled": true
								},
								{
									"key": "order_by",
									"value": "name",
									"disabled": true
								},
								{
									"key": "image_name",
									"value": "alpine"
								},
								{
									"key": "name",
									"value": "alpine"
								},
								{
									"key": "page_size",
									"value": "10",
									"disabled": true
								},
								{
									"key": "repository",
									"value": "azuretestrepo"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "vul_export",
					"id": "f9e34349-cd88-4b6c-95e8-44b548818658",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"token\": \"064728ac-b77f-4497-ab0f-d529fcad8baf\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{CWPP_BASE_URL}}/api/v2/risks/vulnerabilities/exporters/images/stream",
							"host": [
								"{{CWPP_BASE_URL}}"
							],
							"path": [
								"api",
								"v2",
								"risks",
								"vulnerabilities",
								"exporters",
								"images",
								"stream"
							],
							"query": [
								{
									"key": "token",
									"value": "064728ac-b77f-4497-ab0f-d529fcad8baf",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "vul_exporter_jobs",
					"id": "e705c2a6-8934-49f0-ac61-21319fa0173e",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": "{{CWPP_BASE_URL}}/api/v2/risks/vulnerabilities/exporters/images/jobs"
					},
					"response": []
				}
			],
			"id": "00cd38fb-3198-4423-8db4-d19240fbbd24"
		},
		{
			"name": "user_management",
			"item": [
				{
					"name": "create_user",
					"id": "421f2009-d71c-41aa-97b1-507a27d2bb96",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": {
								"token": "{{bearer-token}}"
							}
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\":\"matthew.song+api_tester321@aquasec.com\",\n\n    \"account_admin\":false,\n    \"csp_roles\":[\"test\"]\n}",
							"options": {
								"raw": {
									"language": "text"
								}
							}
						},
						"url": "{{CSPM_BASE_URL}}/v2/users"
					},
					"response": []
				},
				{
					"name": "get_users",
					"id": "63c3f499-888d-4630-9fcc-d12a45324ca7",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "delete me",
								"value": "",
								"type": "text"
							}
						],
						"url": "{{CSPM_BASE_URL}}/v2/users"
					},
					"response": []
				},
				{
					"name": "get_app_scope",
					"id": "887aca6e-fcf1-494a-b2a1-2c1710a91d81",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": {
								"token": "{{bearer-token}}"
							}
						},
						"method": "GET",
						"header": [],
						"url": "{{CWPP_BASE_URL}}/api/v2/access_management/scopes"
					},
					"response": []
				}
			],
			"id": "10ed47bb-d096-4fbc-afb0-5c343c41f92a"
		},
		{
			"name": "set_auth",
			"item": [],
			"id": "af887507-6422-47b9-8e3c-2a8efdd7b91d",
			"description": "This folder has the pre-request script to set the auth token",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "e0126aba-b548-4c69-a6f4-c6a2b5db29f8",
						"type": "text/javascript",
						"exec": [
							"const getJWT = {",
							"    url: `${pm.environment.get('CSPM_BASE_URL')}/v2/signin`,",
							"    method: 'POST',",
							"    header: {",
							"        \"Content-Type\": \"application/json\"",
							"    },",
							"    body: JSON.stringify({",
							"        \"email\": pm.environment.get('USER_EMAIL'),",
							"        \"password\": pm.environment.get('USER_PASSWORD')",
							"  })",
							"}",
							"",
							"pm.sendRequest(getJWT, (err, res) => {",
							"    pm.collectionVariables.set('bearer-token', `${res.json().data.token}`)",
							"    ",
							"    //console.log(pm.collectionVariables.get('bearer-token'))",
							"",
							"    ",
							"})",
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "5549c5ed-f315-46b4-8134-bc645ec01b26",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "new_registry_intergation",
			"id": "7a49415b-c1e9-4833-bbab-b0c9cf5f2a0f",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{bearer-token}}"
					}
				},
				"method": "POST",
				"header": [],
				"url": ""
			},
			"response": []
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": {
			"token": "{{bearer-token}}"
		}
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "a7b0f56d-9096-4720-8881-e629997b5856",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "6d77f56c-25ff-4841-a531-077a093c61ac",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "bearer-token",
			"value": "",
			"type": "string"
		},
		{
			"key": "AccessTokenExpiry",
			"value": "",
			"type": "string",
			"disabled": true
		}
	]
}